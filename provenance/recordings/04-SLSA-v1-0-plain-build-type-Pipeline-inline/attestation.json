{
  "_type": "https://in-toto.io/Statement/v0.1",
  "predicateType": "https://slsa.dev/provenance/v1",
  "subject": [
    {
      "name": "quay.io/lucarval/test-policies-chains",
      "digest": {
        "sha256": "7cd8d408a6184e0923cef34cc6a8b2f012c9faef337272677adf093e3ea73c2a"
      }
    }
  ],
  "predicate": {
    "buildDefinition": {
      "buildType": "https://tekton.dev/chains/v2/slsa",
      "externalParameters": {
        "runSpec": {
          "pipelineSpec": {
            "tasks": [
              {
                "name": "git-clone",
                "taskRef": {
                  "kind": "Task",
                  "resolver": "git",
                  "params": [
                    {
                      "name": "url",
                      "value": "https://github.com/lcarva/ec-policies.git"
                    },
                    {
                      "name": "revision",
                      "value": "727f8cae69fdfbae7cf8a44fd5e2055ad9573fb9"
                    },
                    {
                      "name": "pathInRepo",
                      "value": "integration/task/mock-git-clone.yaml"
                    }
                  ]
                },
                "params": [
                  {
                    "name": "commit",
                    "value": "$(params.commit)"
                  },
                  {
                    "name": "url",
                    "value": "$(params.url)"
                  },
                  {
                    "name": "committer-date",
                    "value": "$(params.committer-date)"
                  }
                ]
              },
              {
                "name": "scan",
                "taskSpec": {
                  "spec": null,
                  "metadata": {},
                  "params": [
                    {
                      "name": "TEST_OUTPUT",
                      "type": "string",
                      "description": "The value to of the TEST_OUTPUT commit result."
                    }
                  ],
                  "description": "This is a dummy task that emulates a task that scans source code. Its sole purpose is to facilitate testing.",
                  "steps": [
                    {
                      "name": "scan",
                      "image": "registry.access.redhat.com/ubi9:latest",
                      "env": [
                        {
                          "name": "TEST_OUTPUT",
                          "value": "$(params.TEST_OUTPUT)"
                        }
                      ],
                      "resources": {},
                      "script": "#!/usr/bin/env sh\nset -euo pipefail\n\necho -n \"${TEST_OUTPUT}\" > \"$(results.TEST_OUTPUT.path)\"\n"
                    }
                  ],
                  "results": [
                    {
                      "name": "TEST_OUTPUT",
                      "type": "string",
                      "description": "The summary scanner output."
                    }
                  ]
                },
                "runAfter": [
                  "git-clone"
                ],
                "params": [
                  {
                    "name": "TEST_OUTPUT",
                    "value": "$(params.TEST_OUTPUT)"
                  }
                ]
              },
              {
                "name": "build",
                "taskRef": {
                  "kind": "Task",
                  "resolver": "bundles",
                  "params": [
                    {
                      "name": "bundle",
                      "value": "quay.io/lucarval/test-policies-chains@sha256:eddc8ae8a13347bd8fdaa1843cc62eac9d3cc12801cd48fe858c087bfba9bd7f"
                    },
                    {
                      "name": "name",
                      "value": "mock-build"
                    },
                    {
                      "name": "kind",
                      "value": "task"
                    }
                  ]
                },
                "runAfter": [
                  "scan"
                ],
                "params": [
                  {
                    "name": "IMAGE_URL",
                    "value": "$(params.IMAGE_URL)"
                  },
                  {
                    "name": "IMAGE_DIGEST",
                    "value": "$(params.IMAGE_DIGEST)"
                  }
                ]
              }
            ],
            "params": [
              {
                "name": "commit",
                "type": "string"
              },
              {
                "name": "url",
                "type": "string"
              },
              {
                "name": "committer-date",
                "type": "string"
              },
              {
                "name": "IMAGE_URL",
                "type": "string"
              },
              {
                "name": "IMAGE_DIGEST",
                "type": "string"
              },
              {
                "name": "TEST_OUTPUT",
                "type": "string"
              }
            ],
            "results": [
              {
                "name": "IMAGE_URL",
                "description": "",
                "value": "$(tasks.build.results.IMAGE_URL)"
              },
              {
                "name": "IMAGE_DIGEST",
                "description": "",
                "value": "$(tasks.build.results.IMAGE_DIGEST)"
              },
              {
                "name": "CHAINS-GIT_URL",
                "description": "",
                "value": "$(tasks.git-clone.results.url)"
              },
              {
                "name": "CHAINS-GIT_COMMIT",
                "description": "",
                "value": "$(tasks.git-clone.results.commit)"
              }
            ]
          },
          "params": [
            {
              "name": "IMAGE_DIGEST",
              "value": "sha256:7cd8d408a6184e0923cef34cc6a8b2f012c9faef337272677adf093e3ea73c2a"
            },
            {
              "name": "IMAGE_URL",
              "value": "quay.io/lucarval/test-policies-chains"
            },
            {
              "name": "TEST_OUTPUT",
              "value": "missing"
            },
            {
              "name": "commit",
              "value": "fc98226c7a4206e9b4e9fe99172ddc3a5ae6edfa"
            },
            {
              "name": "committer-date",
              "value": "1697559014"
            },
            {
              "name": "url",
              "value": "gitspam.spam/spam/spam"
            }
          ],
          "serviceAccountName": "default",
          "timeouts": {
            "pipeline": "1h0m0s"
          }
        }
      },
      "internalParameters": {
        "tekton-pipelines-feature-flags": {
          "DisableAffinityAssistant": false,
          "DisableCredsInit": false,
          "RunningInEnvWithInjectedSidecars": true,
          "RequireGitSSHSecretKnownHosts": false,
          "EnableTektonOCIBundles": false,
          "ScopeWhenExpressionsToTask": false,
          "EnableAPIFields": "beta",
          "SendCloudEventsForRuns": false,
          "AwaitSidecarReadiness": true,
          "EnforceNonfalsifiability": "none",
          "VerificationNoMatchPolicy": "ignore",
          "EnableProvenanceInStatus": true,
          "ResultExtractionMethod": "termination-message",
          "MaxResultSize": 4096,
          "SetSecurityContext": false,
          "Coschedule": "workspaces"
        }
      },
      "resolvedDependencies": [
        {
          "uri": "git+https://github.com/lcarva/ec-policies.git",
          "digest": {
            "sha1": "727f8cae69fdfbae7cf8a44fd5e2055ad9573fb9"
          },
          "name": "pipelineTask"
        },
        {
          "uri": "oci://registry.access.redhat.com/ubi9",
          "digest": {
            "sha256": "20f695d2a91352d4eaa25107535126727b5945bff38ed36a3e59590f495046f0"
          }
        },
        {
          "uri": "quay.io/lucarval/test-policies-chains",
          "digest": {
            "sha256": "eddc8ae8a13347bd8fdaa1843cc62eac9d3cc12801cd48fe858c087bfba9bd7f"
          },
          "name": "pipelineTask"
        },
        {
          "uri": "git+gitspam.spam/spam/spam.git",
          "digest": {
            "sha1": "fc98226c7a4206e9b4e9fe99172ddc3a5ae6edfa"
          },
          "name": "inputs/result"
        }
      ]
    },
    "runDetails": {
      "builder": {
        "id": "https://tekton.dev/chains/v2"
      },
      "metadata": {
        "invocationID": "3db243c8-57cc-47ea-847d-93a1e17bbe79",
        "startedOn": "2023-10-17T16:10:14Z",
        "finishedOn": "2023-10-17T16:10:29Z"
      },
      "byproducts": [
        {
          "name": "pipelineRunResults/IMAGE_URL",
          "mediaType": "application/json",
          "content": "InF1YXkuaW8vbHVjYXJ2YWwvdGVzdC1wb2xpY2llcy1jaGFpbnMi"
        },
        {
          "name": "pipelineRunResults/IMAGE_DIGEST",
          "mediaType": "application/json",
          "content": "InNoYTI1Njo3Y2Q4ZDQwOGE2MTg0ZTA5MjNjZWYzNGNjNmE4YjJmMDEyYzlmYWVmMzM3MjcyNjc3YWRmMDkzZTNlYTczYzJhIg=="
        },
        {
          "name": "pipelineRunResults/CHAINS-GIT_URL",
          "mediaType": "application/json",
          "content": "ImdpdHNwYW0uc3BhbS9zcGFtL3NwYW0i"
        },
        {
          "name": "pipelineRunResults/CHAINS-GIT_COMMIT",
          "mediaType": "application/json",
          "content": "ImZjOTgyMjZjN2E0MjA2ZTliNGU5ZmU5OTE3MmRkYzNhNWFlNmVkZmEi"
        }
      ]
    }
  }
}
